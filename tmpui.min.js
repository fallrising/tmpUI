'use strict';function _defineProperty(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}
class tmpUI{constructor(a,b){_defineProperty(this,"status",{});_defineProperty(this,"config",{});_defineProperty(this,"config_dynamic",!0);_defineProperty(this,"version",0);_defineProperty(this,"index","/");_defineProperty(this,"debug",!0);_defineProperty(this,"reload_table",{});_defineProperty(this,"resPath","");_defineProperty(this,"Babel",!1);_defineProperty(this,"jQuery",!1);_defineProperty(this,"GoogleAnalytics",!1);_defineProperty(this,"googleAnalyticsQueue",[]);_defineProperty(this,"dynamicRouter",
null);_defineProperty(this,"language_config",!1);_defineProperty(this,"language_data",!1);_defineProperty(this,"language_setting","en");_defineProperty(this,"loadDelay",500);_defineProperty(this,"loadCallback",[]);_defineProperty(this,"readyFunction",[]);_defineProperty(this,"loadingPageInit",!1);_defineProperty(this,"loadingPage",!1);_defineProperty(this,"loadingIcon",!1);_defineProperty(this,"loadingText","Loading...");_defineProperty(this,"readyCallback",null);_defineProperty(this,"progress_enable",
!0);_defineProperty(this,"progress_status",!1);_defineProperty(this,"animation_time",500);_defineProperty(this,"animation_stime",0);_defineProperty(this,"currentRoute","/");_defineProperty(this,"onExitfunction",[]);_defineProperty(this,"filesCache",[]);this.state={displayTrophy:!0};window.tmpui_helper={loadQueue:0,loadTotal:0,readyQueue:0,readyTotal:0};this.config_dynamic=!0===b||void 0===b?!0:!1;this.loadConfig(a,c=>{history.replaceState(this.state,null,"");this.config=this.rebuildConfig(c);this.rebuildRunConfig();
this.CheckAddonLib(()=>{this.route();window.addEventListener("popstate",d=>{this.route()})})})}CheckAddonLib(a){if(!0===this.loadBabel&&"undefined"===typeof Babel)return this.log("waitting for Babel"),setTimeout(()=>{this.CheckAddonLib(a)},200),!1;if(!0===this.loadJquery&&"undefined"===typeof jQuery)return this.log("waitting for jQuery"),setTimeout(()=>{this.CheckAddonLib(a)},200),!1;a()}onExit(a){this.onExitfunction.push(a)}doExit(){if(0!==this.onExitfunction.length){for(let a in this.onExitfunction)this.onExitfunction[a]();
this.onExitfunction=[]}}ready(a){this.readyFunction.push(a)}readyExec(){if(0!==this.readyFunction.length){for(let a in this.readyFunction)this.readyFunction[a]();this.readyFunction=[]}this.log("Send GoogleAnalytics : "+document.title);gtag("event","page_view",{page_title:document.title,page_path:this.currentRoute,send_to:this.GoogleAnalytics})}readyEvent(){window.tmpui_helper.readyQueue==window.tmpui_helper.readyTotal?(this.readyExec(),this.log("Ready")):setTimeout(()=>{this.readyEvent()},1E3)}loadConfig(a,
b){let c=new XMLHttpRequest,d={};this.config_dynamic&&(a=a+"?"+Date.parse(new Date));c.onloadend=e=>{200==c.status?(d=JSON.parse(c.responseText),b(d)):this.logError("Load config fail.")};c.open("GET",a,!0);c.send()}loadAddonLib(a){var b=document.createElement("script");b.src=a;b.type="text/javascript";b.async=!1;document.head.appendChild(b)}loadGtag(a){var b=document.createElement("script");b.src="https://www.googletagmanager.com/gtag/js?id="+a;b.type="text/javascript";b.async=!1;document.head.appendChild(b);
a=document.createElement("script");a.innerHTML='window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag(\'js\', new Date());gtag("config", "'+this.GoogleAnalytics+'");';a.type="text/javascript";a.async=!1;document.head.appendChild(a)}rebuildRunConfig(a){void 0!==this.config.loadingPage&&(this.loadingPage=this.config.loadingPage);void 0!==this.config.loadingText&&(this.loadingText=this.config.loadingText);void 0!==this.config.loadingIcon&&(this.loadingIcon=this.config.loadingIcon);
void 0!==this.config.version&&(this.version=this.config.version);void 0!==this.config.language&&(this.language_config=this.config.language);void 0!==this.config.loadingProgress&&(this.progress_enable=this.config.loadingProgress);void 0!==this.config.loadingAnimationTime&&(this.animation_time=this.config.loadingAnimationTime);void 0!==this.config.dynamicRouter&&(this.dynamicRouter=this.config.dynamicRouter);void 0!==this.config.resPath&&(this.resPath=this.config.resPath);void 0!==this.config.pageNotFound&&
(this.pageNotFound=this.config.pageNotFound);!1!==this.config.jQuery&&(this.loadAddonLib(this.config.jQuery),this.log("Load jQuery:"+this.config.jQuery),this.loadJquery=!0);!1!==this.config.Babel&&(this.loadAddonLib(this.config.Babel),this.log("Load Babel:"+this.config.Babel),this.loadBabel=!0);!1!==this.config.GoogleAnalytics&&(this.loadGtag(this.config.GoogleAnalytics),this.log("Load GoogleAnalytics:"+this.config.GoogleAnalytics),this.GoogleAnalytics=this.loadGoogleAnalytics=this.config.GoogleAnalytics)}rebuildConfig(a){if(void 0!==
a.path)for(let c in a.path){a.path[c].res={};if(void 0!==a.path[c].preload)for(let d in a.path[c].preload){var b=a.path[c].preload[d];for(let e in a.preload[b])a.path[c].res[e]={},a.path[c].res[e]=a.preload[b][e]}if(void 0!==a.path[c].body)for(let d in a.path[c].body)a.path[c].res[d]=a.path[c].body[d];if(void 0!==a.path[c].append)for(let d in a.path[c].append){b=a.path[c].append[d];for(let e in a.append[b])a.path[c].res[e]={},a.path[c].res[e]=a.append[b][e]}}a.reload_table={};return a}linkRebind(){var a=
document.getElementsByTagName("a");if(0<a.length)for(let b in a)if("object"===typeof a[b]&&"PRE"!==a[b].parentNode.nodeName&&"CODE"!==a[b].parentNode.nodeName&&"true"==a[b].getAttribute("tmpui-app")&&"true"!=a[b].getAttribute("tmpui-app-rebind")){let c="_blank"==a[b].getAttribute("target")?!0:!1,d="",e=a[b].getAttribute("href").split("?");d=1===e.length?this.index+"?tmpui_page="+e[0]:this.index+"?tmpui_page="+e[0]+"&"+e[1];a[b].setAttribute("tmpui-app-rebind","true");a[b].setAttribute("href",d);c||
a[b].addEventListener("click",g=>{g.preventDefault();console.log(d);history.pushState({newPage:d},null,d);this.route()})}a=document.getElementsByTagName("code");if(0<a.length)for(let b in a)"object"===typeof a[b]&&"true"==a[b].getAttribute("tmpui-html-code")&&(a[b].innerHTML=a[b].innerHTML.toString().replace(/[<>&"]/g,c=>({"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"})[c]),a[b].setAttribute("tmpui-html-code","loaded"));return"ok"}autofix(){if(""!==this.config.siteroot){var a=this.config.siteroot;
$("[tmpui-root]").each(function(){var b=$(this).attr("tmpui-root"),c=$(this).attr("src"),d=$(this).attr("href");"true"===b&&void 0!==c&&null!==c&&($(this).attr("src",a+c),$(this).attr("tmpui-root","false"));"true"===b&&void 0!==d&&null!==d&&($(this).attr("href",a+d),$(this).attr("tmpui-root","false"))})}}open(a,b){a=this.index+"?tmpui_page="+a;if(!0===b)return window.open(a),!1;history.pushState({newPage:a},null,a);this.route()}route(){let a="/";var b=null;b=window.location.href;""!==window.location.hash&&
(b=window.location.href.substr(0,window.location.href.indexOf(window.location.hash)));let c=window.location.href.replace(window.location.origin,"");this.log("Send GoogleAnalytics : "+c);this.currentRoute=c;b=this.getUrlVars(b);void 0!==b.tmpui_page&&(a=b.tmpui_page);$(".tmpUIRes").remove();this.loadpage(!0);if(void 0===this.config.path[a]){if(null!==this.dynamicRouter){b=this.resPath+this.dynamicRouter+a+".json";let d=new XMLHttpRequest;d.onloadend=()=>{200==d.status||304==d.status?(this.config.path[a]=
JSON.parse(d.responseText),this.rebuildConfig(this.config),this.route_core(a)):this.route_unfound(a)};d.open("GET",b+"?v="+this.version,!0);d.send();return!0}this.route_unfound(a);return!1}this.route_core(a)}route_core(a){this.loaderStart(a,()=>{document.title=this.config.path[a].title;this.draw(a);this.autofix();this.linkRebind();setTimeout(()=>{this.loadpage(!1)},this.loadDelay)})}route_unfound(a){null!==this.pageNotFound&&(console.log(this.pageNotFound),this.route_core(this.pageNotFound));this.log("Page not found : "+
a);return!1}draw(a){for(let b in this.config.path[a].res){let c=this.config.path[a].res[b].type,d=this.config.path[a].res[b].dom,e=this.config.path[a].res[b].reload;if("js"===c||"js-es6"===c)"js-es6"===c&&(d=Babel.transform(d,{presets:["es2015","stage-3"]}).code),!1===e?!1===this.reload_table[b]&&(this.reload_table[b]=!0,window.tmpui_helper.readyTotal++,$("body").append('<script class="tmpUIRes_once" type="text/javascript" ">\n'+d+";\nwindow.tmpui_helper.readyQueue++;\x3c/script>\n")):(window.tmpui_helper.readyTotal++,
$("body").append('<script class="tmpUIRes" type="text/javascript" ">\n'+d+";\nwindow.tmpui_helper.readyQueue++;\x3c/script>\n"));"css"===c&&(!1===e?!1===this.reload_table[b]&&(this.reload_table[b]=!0,$("head").append('<link class="tmpUIRes_once" rel="stylesheet" href="'+b+"?v="+this.config.version+'" >\n')):$("head").append('<link class="tmpUIRes" rel="stylesheet" href="'+b+"?v="+this.config.version+'" >\n'));"tpl"===c&&(!1===e?!1===this.reload_table[b]&&(this.reload_table[b]=!0,$("body").append('<div class="tmpUIRes_once" style="display:none" ">\n'+
d+"</div>\n")):$("body").append('<div class="tmpUIRes" style="display:none" ">\n'+d+"</div>\n"));"file"===c&&(this.filesCache[b]=d,!1===this.reload_table[b]&&(this.reload_table[b]=!0));"html"===c&&("append"===this.config.path[a].res[b].target.type&&$("#tmpui_body").append(d),"body"===this.config.path[a].res[b].target.type&&$("#tmpui_body").html(d),"id"===this.config.path[a].res[b].target.type&&$("#"+this.config.path[a].res[b].target.val).replaceWith(d));this.log(b)}!1!==this.language_config&&this.language_build();
this.readyEvent()}loaderStart(a,b){this.loadCallback=b;for(let c in this.config.path[a].res)window.tmpui_helper.loadTotal++;for(let c in this.config.path[a].res)this.loaderUnit(a,c)}loaderUnit(a,b){void 0===this.config.path[a].res[b].state&&(this.config.path[a].res[b].state=0,this.config.path[a].res[b].dom=0);!1===this.config.path[a].res[b].reload&&void 0===this.reload_table[b]&&(this.reload_table[b]=!1);if(1===this.config.path[a].res[b].state)window.tmpui_helper.loadQueue++,this.loaderFinish();else{let c=
new XMLHttpRequest;c.onloadend=()=>{"200"!=c.status&&"302"!=c.status&&this.logError("can't load [http code "+c.status+"]"+b);window.tmpui_helper.loadQueue++;this.config.path[a].res[b].state=1;this.config.path[a].res[b].dom=c.responseText;this.loaderFinish()};c.ontimeout=()=>{this.logError("can't load [timeout]"+b)};c.onerror=()=>{this.logError("can't load [error]"+b)};c.onabort=()=>{this.logError("can't load [abort]"+b)};c.open("GET",this.resPath+b+"?v="+this.version,!0);c.send()}}loaderFinish(){this.progress_enable&&
!1===this.progress_status&&(this.progress_status=!0,this.animation_slice(),$("#tmpui_loading_show").append('<div class="tmpui_progress tmpui_round_conner" id="tmpui_loading_progress"><div class="tmpui_curRate tmpui_round_conner"></div></div>'));let a=Math.ceil(window.tmpui_helper.loadQueue/window.tmpui_helper.loadTotal*100);$(".tmpui_curRate").animate({width:a+"%"},this.animation_stime,()=>{100===a&&($("#tmpui_loading_progress").fadeOut(),$("body").css("overflow",""),$("#tmpui").fadeOut())});if(window.tmpui_helper.loadQueue==
window.tmpui_helper.loadTotal){this.log("Loading is complete.");if("function"===typeof this.loadCallback){this.log("Callback is running.");try{this.loadCallback()}catch(b){this.logError("The callback contains errors, please check.")}}this.loadCallback=null;this.progress_status=!0}}animation_slice(){this.animation_stime=1<window.tmpui_helper.loadTotal?Math.ceil(this.animation_time/window.tmpui_helper.loadTotal):this.animation_time;this.log("Animation slice time: "+this.animation_stime+" ,total: "+
this.animation_time)}title(a){$("title").html(a)}language_set(a){if(localStorage.getItem("language")===a)return!1;localStorage.setItem("language",a);this.language_build()}language_get(){return localStorage.getItem("language")}language_build(){var a=localStorage.getItem("language");this.log("language setting...."+a);if(null===a){a=navigator.language;this.language_setting="en";if("zh-CN"===a||"zh-SG"===a||"zh"===a)this.language_setting="cn";if("zh-TW"===a||"zh-HK"===a)this.language_setting="hk";if("ja"===
a||"ja-JP"===a)this.language_setting="jp";if("ru"===a||"ru-MI"===a)this.language_setting="ru";"ko"===a&&(this.language_setting="kr");"ms"===a&&(this.language_setting="my");localStorage.setItem("language",this.language_setting)}else this.language_setting=a;window.tmpui_helper.readyTotal++;$.get(this.language_config[this.language_setting]+"?v="+this.version,b=>{window.tmpui_helper.readyQueue++;this.language_data=b;var c={};null!=b&&(c=b);$("[i18n]").each(function(d){d=$(this).attr("i18n-only");null==
$(this).val()||""==$(this).val()||null!=d&&void 0!=d&&""!=d&&"value"!=d||$(this).val(c[$(this).attr("i18n")]);null==$(this).html()||""==$(this).html()||null!=d&&void 0!=d&&""!=d&&"html"!=d||$(this).html(c[$(this).attr("i18n")]);null==$(this).attr("placeholder")||""==$(this).attr("placeholder")||null!=d&&void 0!=d&&""!=d&&"placeholder"!=d||$(this).attr("placeholder",c[$(this).attr("i18n")]);null==$(this).attr("content")||""==$(this).attr("content")||null!=d&&void 0!=d&&""!=d&&"content"!=d||$(this).attr("content",
c[$(this).attr("i18n")]);null==$(this).attr("title")||""==$(this).attr("title")||null!=d&&void 0!=d&&""!=d&&"title"!=d||$(this).attr("title",c[$(this).attr("i18n")])})},"json")}description(a){$("meta[name=description]").attr("content",a)}loadpage(a){if(!this.loadingPage)return this.log("Loading page exit."),this.ready_exec(),!1;this.loadingPageInit||($("#tmpui").append('<div id="tmpui_loading_bg" style="background-color: rgba(255, 255, 255, 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter: saturate(180%) blur(20px);"></div>'),
$("#tmpui_loading_bg").append('<div id="tmpui_loading_show"></div>'),$("#tmpui_loading_show").append('<div style="text-align:center;margin-bottom:20px;" id="tmpui_loading_content"></div>'),!1!==this.loadingIcon?$("#tmpui_loading_content").append('<img src="'+this.loadingIcon+'" style="vertical-align: middle;border-style: none;width:129px;height:129px;"/>'):$("#tmpui_loading_content").append('<div style="text-align:center;font-family: fa5-proxima-nova,"Helvetica Neue",Helvetica,Arial,sans-serif;">'+
this.loadingText+"</div>"),this.loadingPageInit=!0,this.log("Loading page created."));if(a)$("body").css("overflow","hidden"),$("#tmpui").show(),this.doExit(),this.log("Loading page on");else{this.log("Loading page off");if(this.progress_enable)return!0;$("body").css("overflow","");$("#tmpui").fadeOut()}}getFile(a){return this.filesCache[a]}tpl(a,b){a=$("#"+a).html();return this.templateEngine(a,b)}templateEngine(a,b){if(""==a||null==a)return console.error("templateEngine::Html can't be null."),"";
for(var c=/<%(.+?)%>/g,d=/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g,e="with(obj) { var r=[];\n",g=0,l,h,k=function(f,m){m?e+=f.match(d)?f+"\n":"r.push("+f+");\n":e+=""!=f?'r.push("'+f.replace(/"/g,'\\"')+'");\n':"";return k};h=c.exec(a);)k(a.slice(g,h.index))(h[1],!0),g=h.index+h[0].length;k(a.substr(g,a.length-g));e=(e+'return r.join(""); }').replace(/[\r\t\n]/g," ");try{l=(new Function("obj",e)).apply(b,[b])}catch(f){console.error("'"+f.message+"'"," in \n\nCode:\n",e,"\n")}return l}getUrlVars(a){var b=
{};a.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(c,d,e){b[d]=e});return b}log(a){this.debug&&console.log("tmpUI::Log -> "+a)}logError(a){console.error("tmpUI::Error -> "+a)}};